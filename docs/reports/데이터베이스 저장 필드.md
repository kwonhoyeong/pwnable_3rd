# 데이터베이스 저장 필드 명세

본 시스템은 PostgreSQL을 사용하여 분석 데이터를 구조화하여 저장합니다. 주요 테이블과 저장 필드는 다음과 같습니다.

## 1. 패키지-CVE 매핑 (package_cve_mapping)
패키지와 보안 취약점(CVE) 간의 연관 관계를 저장하는 테이블입니다.

| 필드명 | 데이터 타입 | 설명 | 비고 |
| :--- | :--- | :--- | :--- |
| `id` | SERIAL | 고유 식별자 | PK |
| `package` | TEXT | 패키지 이름 | 예: react |
| `version_range` | TEXT | 영향받는 버전 범위 | 예: <17.0.2 |
| `ecosystem` | TEXT | 패키지 생태계 | Default: npm |
| `cve_ids` | TEXT[] | 연관된 CVE ID 목록 | 배열 형태 |
| `updated_at` | TIMESTAMPTZ | 마지막 업데이트 시간 | |

## 2. 분석 결과 (analysis_results)
AI가 분석한 최종 위험도 평가 결과를 저장하는 핵심 테이블입니다.

| 필드명 | 데이터 타입 | 설명 | 비고 |
| :--- | :--- | :--- | :--- |
| `cve_id` | TEXT | CVE 식별자 | Unique |
| `risk_level` | TEXT | 위험 등급 | CRITICAL, HIGH, MEDIUM, LOW |
| `risk_score` | NUMERIC(4,1) | 종합 위험 점수 | 0.0 ~ 10.0 |
| `analysis_summary` | TEXT | AI 분석 요약 | Markdown 포맷 |
| `recommendations` | TEXT[] | 대응 권장사항 | 배열 형태 |
| `generated_at` | TIMESTAMPTZ | 분석 생성 시점 | |

## 3. 정량적 점수 데이터 (Scores)
외부 소스(NVD, FIRST)에서 수집한 객관적 지표를 저장합니다.

### 3.1 CVSS 점수 (cvss_scores)
| 필드명 | 데이터 타입 | 설명 |
| :--- | :--- | :--- |
| `cve_id` | TEXT | CVE 식별자 |
| `cvss_score` | NUMERIC(4,1) | 기본 점수 (Base Score) |
| `vector` | TEXT | CVSS 벡터 문자열 |
| `collected_at` | TIMESTAMPTZ | 수집 시점 |

### 3.2 EPSS 점수 (epss_scores)
| 필드명 | 데이터 타입 | 설명 |
| :--- | :--- | :--- |
| `cve_id` | TEXT | CVE 식별자 |
| `epss_score` | NUMERIC(5,4) | 실제 악용 확률 점수 |
| `collected_at` | TIMESTAMPTZ | 수집 시점 |

## 4. 위협 사례 (threat_cases)
수집된 실제 공격 사례 및 위협 인텔리전스 정보를 저장합니다.

| 필드명 | 데이터 타입 | 설명 |
| :--- | :--- | :--- |
| `cve_id` | TEXT | CVE 식별자 |
| `package` | TEXT | 관련 패키지명 |
| `cases` | JSONB | 위협 사례 데이터 | JSON 구조체 |
| `updated_at` | TIMESTAMPTZ | 마지막 업데이트 시간 |
